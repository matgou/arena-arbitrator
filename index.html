<html>
<head>

</head>
<body>
Arena : 
<a onclick="previus()" href="javascript:void(0);">Previus</a>
<a onclick="stop()" href="javascript:void(0);">Stop</a>
<a onclick="play()" href="javascript:void(0);">Play</a>
<a onclick="next()" href="javascript:void(0);">Next</a>
<div id="div_canvas">
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
  var canvas = document.createElement('canvas'),
      context = canvas.getContext('2d');
  auto_next = false;
  canvas.width = 1024;
  canvas.height = 1024;
  div = document.getElementById("div_canvas");
  div.appendChild(canvas);

  function render(data) {
    //window.requestAnimationFrame();

    context.fillStyle = '#fff';
    context.fillRect(0, 0, canvas.width, canvas.height);

    context.beginPath();

    for (var i = 0; i < data.length; i += 1) {
        var vertices = data[i];

        context.moveTo(vertices[0].x, vertices[0].y);
        for (var j = 1; j < vertices.length; j += 1) {
            context.lineTo(vertices[j].x, vertices[j].y);
        }

        context.lineTo(vertices[0].x, vertices[0].y);
    }

    context.lineWidth = 1;
    context.strokeStyle = '#999';
    context.stroke();
  }

  var socket = io('http://localhost:8080');
  socket.emit('next', { });
  socket.on('message', function (data) {
	render(JSON.parse(data).world);
	if(auto_next) {
		next();
	}
  });
  function play() {
	auto_next=true
	next();
  }
  function stop() {
	auto_next=false
  }
  function next() {
	console.log("Next !");
	socket.emit('next', { });
  }
  function previus() {
	console.log("previus !");
	socket.emit('previus', { });
  }


</script>
</body>
</html>
